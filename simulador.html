<!DOCTYPE html>
<html>

<body>

  <label>Escolha o estado:</label>
  <select id="municipios" onchange="changeFunc();"></select>
  <br><br>
  <input id="1" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="2" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="3" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="4" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="5" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="6" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="7" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="8" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <input id="9" type="range" min="0" max="100" step="1" value="50" data-orientation="vertical">
  <br>
  <button onclick="teste()">teste</button>
  <input id="morte" type="text">

  <script src="http://idsimulador.herokuapp.com/muni/municipios_data.json"></script>

  <script>
    function changeFunc() {
      var selectBox = document.getElementById("municipios");
      var selectedValue = selectBox.options[selectBox.selectedIndex].value;

      console.log("mort ", dados[selectedValue].Mortalidade_infantil * 100)

      document.getElementById("morte").value = dados[selectedValue].Mortalidade_infantil * 100

      document.getElementById("1").value = dados[selectedValue].Coleta_de_Lixo * 100
      document.getElementById("2").value = dados[selectedValue].IDHM_Educacao * 100
      document.getElementById("3").value = dados[selectedValue].Renda_per_capita * 100
      document.getElementById("4").value = dados[selectedValue].Grau_de_Urbanizacao * 100
      document.getElementById("5").value = dados[selectedValue].Esgoto_Sanitario * 100
      document.getElementById("6").value = dados[selectedValue].Estab_por_mil_Hab * 100
      document.getElementById("7").value = dados[selectedValue].Doses_Aplicadas_mil_Hab * 100
      document.getElementById("8").value = dados[selectedValue].Razao_Medico_mil_Hab * 100
      document.getElementById("9").value = dados[selectedValue].Abastecimento_de_Agua * 100
    }
    function teste() {
      var x = document.getElementById("1").value;
      
      var requestOptions = {
        method: 'GET', //mode: 'cors',//'no-cors', 
        headers: {
          "Content-Type": "application/json",
          "Cod_IBGE": document.getElementById("municipios").value,
          "Mortalidade_infantil": document.getElementById("morte").value/100,
          "idhm_educacao": document.getElementById("1").value/100,
          "IDHM_Educacao": document.getElementById("1").value/100,
          "Renda_per_capita": document.getElementById("2").value/100,
          "Grau_de_Urbanizacao": document.getElementById("3").value/100,
          "Esgoto_Sanitario": document.getElementById("4").value/100,
          "Estab_por_mil_Hab": document.getElementById("5").value/100,
          "Doses_Aplicadas_mil_Hab": document.getElementById("6").value/100,
          "Razao_Medico_mil_Hab": document.getElementById("7").value/100,
          "Abastecimento_de_Agua": document.getElementById("8").value/100,
          "Coleta_de_Lixo": document.getElementById("9").value/100,
        }
        //, redirect: 'follow'
      };

      console.log("AAAAAAAAAAAAAAAAAAAAA ", requestOptions)

      var url = 'http://idsimulador.herokuapp.com/api'
      fetch(url, requestOptions)
        .then(function (response) {
          return response.json();
        })
        .then(data => {
          console.log(data)
          document.getElementById("morte").innerHTML = data*100;
        })

    }
    var html = "<option value='none'>Escolha</option>"
    for (let index = 0; index < dados.length; index++) {
      const e = dados[index];
      html += "<option value=" + index + ">" + e.Municipio + "</option>"
    }
    document.getElementById("municipios").innerHTML = html;
  </script>
</body>

</html>